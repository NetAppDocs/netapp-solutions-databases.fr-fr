---
sidebar: sidebar 
permalink: dbops/hybrid-dbops-sc-gs-aws.html 
summary: Cette section décrit le processus de déploiement de Cloud Manager et de Cloud Volumes ONTAP dans AWS. 
keywords: AWS, cloud volumes ontap, cloud manager, deploy 
---
= Premiers pas avec le cloud public AWS
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Cette section décrit le processus de déploiement de Cloud Manager et de Cloud Volumes ONTAP dans AWS.



== Cloud public AWS


NOTE: Pour faciliter le suivi, nous avons créé ce document basé sur un déploiement dans AWS.  Cependant, le processus est très similaire pour Azure et GCP.



=== 1. Contrôle pré-vol

Avant le déploiement, assurez-vous que l’infrastructure est en place pour permettre le déploiement à l’étape suivante.  Cela comprend les éléments suivants :

* compte AWS
* VPC dans la région de votre choix
* Sous-réseau avec accès à l'Internet public
* Autorisations pour ajouter des rôles IAM à votre compte AWS
* Une clé secrète et une clé d'accès pour votre utilisateur AWS




=== 2. Étapes pour déployer Cloud Manager et Cloud Volumes ONTAP dans AWS


NOTE: Il existe de nombreuses méthodes pour déployer Cloud Manager et Cloud Volumes ONTAP; cette méthode est la plus simple mais nécessite le plus d'autorisations.  Si cette méthode n'est pas adaptée à votre environnement AWS, veuillez consulter le https://docs.netapp.com/us-en/occm/task_creating_connectors_aws.html["Documentation NetApp Cloud"^] .



==== Déployer le connecteur Cloud Manager

. Accéder à https://www.netapp.com/bluexp/?utm_campaign=b2d-port-all-na-amer-digi-wepp-brand-amer-1745924643379&utm_source=google&utm_medium=paidsearch&utm_content=nativead&gad_source=1&gad_campaignid=21281798861&gclid=EAIaIQobChMIv_GU0KDJjQMVEXRHAR2A2hJzEAAYASAAEgKAZ_D_BwE["NetApp BlueXP"^] et connectez-vous ou inscrivez-vous.
+
image:cloud-central-login-page.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Après vous être connecté, vous devriez être redirigé vers le Canvas.
+
image:cloud-central-canvas-page.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Cliquez sur « Ajouter un environnement de travail » et choisissez Cloud Volumes ONTAP dans AWS.  Ici, vous choisissez également si vous souhaitez déployer un système à nœud unique ou une paire à haute disponibilité.  J'ai choisi de déployer une paire haute disponibilité.
+
image:cloud-central-add-we-026.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Si aucun connecteur n'a été créé, une fenêtre contextuelle apparaît vous demandant de créer un connecteur.
+
image:cloud-central-add-conn-001.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Cliquez sur Commencer, puis choisissez AWS.
+
image:cloud-central-add-conn-003.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Entrez votre clé secrète et votre clé d'accès.  Assurez-vous que votre utilisateur dispose des autorisations appropriées décrites sur le https://mysupport.netapp.com/site/info/cloud-manager-policies["Page des politiques NetApp"^] .
+
image:cloud-central-add-conn-004.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Donnez un nom au connecteur et utilisez un rôle prédéfini comme décrit sur le https://mysupport.netapp.com/site/info/cloud-manager-policies["Page des politiques NetApp"^] ou demandez à Cloud Manager de créer le rôle pour vous.
+
image:cloud-central-add-conn-005.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Fournissez les informations réseau nécessaires au déploiement du connecteur.  Vérifiez que l'accès Internet sortant est activé en :
+
.. Attribuer au connecteur une adresse IP publique
.. Donner au connecteur un proxy pour fonctionner
.. Donner au connecteur un itinéraire vers l'Internet public via une passerelle Internet
+
image:cloud-central-add-conn-006.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]



. Assurez la communication avec le connecteur via SSH, HTTP et HTTPS en fournissant un groupe de sécurité ou en créant un nouveau groupe de sécurité.  J'ai activé l'accès au connecteur à partir de mon adresse IP uniquement.
+
image:cloud-central-add-conn-007.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Consultez les informations sur la page récapitulative et cliquez sur Ajouter pour déployer le connecteur.
+
image:cloud-central-add-conn-008.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Le connecteur se déploie désormais à l’aide d’une pile de formation cloud.  Vous pouvez suivre sa progression depuis Cloud Manager ou via AWS.
+
image:cloud-central-add-conn-009.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Une fois le déploiement terminé, une page de réussite s’affiche.
+
image:cloud-central-add-conn-010.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]





==== Déployer Cloud Volumes ONTAP

. Sélectionnez AWS et le type de déploiement en fonction de vos besoins.
+
image:cloud-central-add-we-001.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Si aucun abonnement n'a été attribué et que vous souhaitez acheter avec PAYGO, choisissez Modifier les informations d'identification.
+
image:cloud-central-add-we-002.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez Ajouter un abonnement.
+
image:cloud-central-add-we-003.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez le type de contrat auquel vous souhaitez souscrire.  J'ai choisi le paiement à l'utilisation.
+
image:cloud-central-add-we-004.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Vous êtes redirigé vers AWS ; choisissez Continuer pour vous abonner.
+
image:cloud-central-add-we-005.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Abonnez-vous et vous serez redirigé vers NetApp Cloud Central.  Si vous êtes déjà abonné et que vous n'êtes pas redirigé, choisissez le lien « Cliquez ici ».
+
image:cloud-central-add-we-006.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Vous êtes redirigé vers Cloud Central où vous devez nommer votre abonnement et l'attribuer à votre compte Cloud Central.
+
image:cloud-central-add-we-007.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. En cas de réussite, une page de coche apparaît.  Revenez à votre onglet Gestionnaire de Cloud.
+
image:cloud-central-add-we-008.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. L'abonnement apparaît désormais dans Cloud Central.  Cliquez sur Appliquer pour continuer.
+
image:cloud-central-add-we-009.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Saisissez les détails de l’environnement de travail tels que :
+
.. Nom du cluster
.. Mot de passe du cluster
.. Balises AWS (facultatif)
+
image:cloud-central-add-we-010.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]



. Choisissez les services supplémentaires que vous souhaitez déployer.  Pour en savoir plus sur ces services, visitez le https://bluexp.netapp.com/["BlueXP: des opérations de gestion de données modernes simplifiées"^] .
+
image:cloud-central-add-we-011.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez de déployer dans plusieurs zones de disponibilité (nécessite trois sous-réseaux, chacun dans une zone de disponibilité différente) ou dans une seule zone de disponibilité.  J'ai choisi plusieurs AZ.
+
image:cloud-central-add-we-012.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez la région, le VPC et le groupe de sécurité dans lesquels le cluster doit être déployé.  Dans cette section, vous attribuez également les zones de disponibilité par nœud (et médiateur) ainsi que les sous-réseaux qu'ils occupent.
+
image:cloud-central-add-we-013.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez les méthodes de connexion pour les nœuds ainsi que le médiateur.
+
image:cloud-central-add-we-014.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]




TIP: Le médiateur nécessite une communication avec les API AWS.  Une adresse IP publique n'est pas requise tant que les API sont accessibles après le déploiement de l'instance EC2 du médiateur.

. Les adresses IP flottantes sont utilisées pour permettre l'accès aux différentes adresses IP utilisées par Cloud Volumes ONTAP , y compris la gestion des clusters et les adresses IP de service de données.  Il doit s'agir d'adresses qui ne sont pas déjà routables au sein de votre réseau et qui sont ajoutées aux tables de routage de votre environnement AWS.  Ces éléments sont nécessaires pour permettre des adresses IP cohérentes pour une paire HA lors du basculement.  Vous trouverez plus d'informations sur les adresses IP flottantes dans le https://docs.netapp.com/us-en/occm/reference_networking_aws.html#requirements-for-ha-pairs-in-multiple-azs["Documentation NetApp Cloud"^] .
+
image:cloud-central-add-we-015.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Sélectionnez les tables de routage auxquelles les adresses IP flottantes sont ajoutées.  Ces tables de routage sont utilisées par les clients pour communiquer avec Cloud Volumes ONTAP.
+
image:cloud-central-add-we-016.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez d'activer le chiffrement géré par AWS ou AWS KMS pour chiffrer les disques racine, de démarrage et de données ONTAP .
+
image:cloud-central-add-we-017.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez votre modèle de licence.  Si vous ne savez pas lequel choisir, contactez votre représentant NetApp .
+
image:cloud-central-add-we-018.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Sélectionnez la configuration la mieux adaptée à votre cas d’utilisation.  Ceci est lié aux considérations de dimensionnement abordées dans la page des prérequis.
+
image:cloud-central-add-we-019.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. En option, créez un volume.  Ce n’est pas obligatoire, car les étapes suivantes utilisent SnapMirror, qui crée les volumes pour nous.
+
image:cloud-central-add-we-020.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Passez en revue les sélections effectuées et cochez les cases pour vérifier que vous comprenez que Cloud Manager déploie des ressources dans votre environnement AWS.  Lorsque vous êtes prêt, cliquez sur Aller.
+
image:cloud-central-add-we-021.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Cloud Volumes ONTAP démarre maintenant son processus de déploiement.  Cloud Manager utilise les API AWS et les piles de formation cloud pour déployer Cloud Volumes ONTAP.  Il configure ensuite le système selon vos spécifications, vous offrant ainsi un système prêt à l'emploi qui peut être utilisé instantanément.  Le calendrier de ce processus varie en fonction des sélections effectuées.
+
image:cloud-central-add-we-022.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Vous pouvez suivre la progression en accédant à la chronologie.
+
image:cloud-central-add-we-023.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. La chronologie agit comme un audit de toutes les actions effectuées dans Cloud Manager.  Vous pouvez afficher tous les appels d'API effectués par Cloud Manager lors de la configuration sur AWS ainsi que sur le cluster ONTAP .  Cela peut également être utilisé efficacement pour résoudre tous les problèmes auxquels vous êtes confronté.
+
image:cloud-central-add-we-024.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Une fois le déploiement terminé, le cluster CVO apparaît sur le canevas, avec la capacité actuelle.  Le cluster ONTAP dans son état actuel est entièrement configuré pour permettre une véritable expérience prête à l'emploi.
+
image:cloud-central-add-we-025.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]





==== Configurer SnapMirror depuis le site vers le cloud

Maintenant que vous disposez d’un système ONTAP source et d’un système ONTAP de destination déployés, vous pouvez répliquer des volumes contenant des données de base de données dans le cloud.

Pour un guide sur les versions ONTAP compatibles pour SnapMirror, consultez le https://docs.netapp.com/ontap-9/index.jsp?topic=%2Fcom.netapp.doc.pow-dap%2FGUID-0810D764-4CEA-4683-8280-032433B1886B.html["Matrice de compatibilité SnapMirror"^] .

. Cliquez sur le système ONTAP source (sur site) et faites-le glisser vers la destination, sélectionnez Réplication > Activer ou sélectionnez Réplication > Menu > Répliquer.
+
image:cloud-central-replication-001.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

+
Sélectionnez Activer.

+
image:cloud-central-replication-002.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

+
Ou Options.

+
image:cloud-central-replication-003.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

+
Reproduire.

+
image:cloud-central-replication-004.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Si vous n’avez pas fait de glisser-déposer, choisissez le cluster de destination vers lequel répliquer.
+
image:cloud-central-replication-005.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez le volume que vous souhaitez répliquer.  Nous avons répliqué les données et tous les volumes de journaux.
+
image:cloud-central-replication-006.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez le type de disque de destination et la politique de hiérarchisation.  Pour la reprise après sinistre, nous recommandons un SSD comme type de disque et pour maintenir la hiérarchisation des données.  La hiérarchisation des données hiérarchise les données en miroir dans un stockage d'objets à faible coût et vous permet d'économiser de l'argent sur les disques locaux.  Lorsque vous rompez la relation ou clonez le volume, les données utilisent le stockage local rapide.
+
image:cloud-central-replication-007.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Sélectionnez le nom du volume de destination : nous avons choisi `[source_volume_name]_dr` .
+
image:cloud-central-replication-008.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Sélectionnez le taux de transfert maximal pour la réplication.  Cela vous permet d'économiser de la bande passante si vous disposez d'une connexion à faible bande passante au cloud, comme un VPN.
+
image:cloud-central-replication-009.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Définir la politique de réplication.  Nous avons choisi un miroir, qui prend l’ensemble de données le plus récent et le réplique dans le volume de destination.  Vous pouvez également choisir une politique différente en fonction de vos besoins.
+
image:cloud-central-replication-010.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Choisissez le calendrier de déclenchement de la réplication.  NetApp recommande de définir une planification « quotidienne » pour le volume de données et une planification « horaire » pour les volumes de journaux, bien que cela puisse être modifié en fonction des besoins.
+
image:cloud-central-replication-011.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Vérifiez les informations saisies, cliquez sur Accéder pour déclencher l’homologue du cluster et l’homologue SVM (s’il s’agit de votre première réplication entre les deux clusters), puis implémentez et initialisez la relation SnapMirror .
+
image:cloud-central-replication-012.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Continuez ce processus pour les volumes de données et les volumes de journaux.
. Pour vérifier toutes vos relations, accédez à l’onglet Réplication dans Cloud Manager.  Ici, vous pouvez gérer vos relations et vérifier leur statut.
+
image:cloud-central-replication-013.png["Figure montrant une boîte de dialogue d'entrée/sortie ou représentant un contenu écrit"]

. Une fois tous les volumes répliqués, vous êtes dans un état stable et prêt à passer aux flux de travail de reprise après sinistre et de développement/test.




=== 3. Déployer une instance de calcul EC2 pour la charge de travail de la base de données

AWS a préconfiguré des instances de calcul EC2 pour diverses charges de travail.  Le choix du type d'instance détermine le nombre de cœurs de processeur, la capacité de mémoire, le type et la capacité de stockage, ainsi que les performances du réseau.  Pour les cas d'utilisation, à l'exception de la partition du système d'exploitation, le stockage principal pour exécuter la charge de travail de la base de données est alloué à partir de CVO ou du moteur de stockage FSx ONTAP .  Par conséquent, les principaux facteurs à prendre en compte sont le choix des cœurs de processeur, de la mémoire et du niveau de performance du réseau.  Les types d'instances AWS EC2 typiques peuvent être trouvés ici : https://us-east-2.console.aws.amazon.com/ec2/v2/home?region=us-east-2#InstanceTypes:["Type d'instance EC2"] .



==== Dimensionnement de l'instance de calcul

. Sélectionnez le type d’instance approprié en fonction de la charge de travail requise.  Les facteurs à prendre en compte incluent le nombre de transactions commerciales à prendre en charge, le nombre d’utilisateurs simultanés, la taille de l’ensemble de données, etc.
. Le déploiement de l'instance EC2 peut être lancé via le tableau de bord EC2.  Les procédures de déploiement exactes dépassent le cadre de cette solution.  Voir https://aws.amazon.com/pm/ec2/?trk=ps_a134p000004f2ZGAAY&trkCampaign=acq_paid_search_brand&sc_channel=PS&sc_campaign=acquisition_US&sc_publisher=Google&sc_category=Cloud%20Computing&sc_country=US&sc_geo=NAMER&sc_outcome=acq&sc_detail=%2Bec2%20%2Bcloud&sc_content=EC2%20Cloud%20Compute_bmm&sc_matchtype=b&sc_segment=536455698896&sc_medium=ACQ-P|PS-GO|Brand|Desktop|SU|Cloud%20Computing|EC2|US|EN|Text&s_kwcid=AL!4422!3!536455698896!b!!g!!%2Bec2%20%2Bcloud&ef_id=EAIaIQobChMIua378M-p8wIVToFQBh0wfQhsEAMYASAAEgKTzvD_BwE:G:s&s_kwcid=AL!4422!3!536455698896!b!!g!!%2Bec2%20%2Bcloud["Amazon EC2"] pour plus de détails.




==== Configuration d'instance Linux pour la charge de travail Oracle

Cette section contient des étapes de configuration supplémentaires après le déploiement d'une instance EC2 Linux.

. Ajoutez une instance de secours Oracle au serveur DNS pour la résolution de noms dans le domaine de gestion SnapCenter .
. Ajoutez un ID utilisateur de gestion Linux comme informations d’identification du système d’exploitation SnapCenter avec des autorisations sudo sans mot de passe.  Activez l’ID avec l’authentification par mot de passe SSH sur l’instance EC2.  (Par défaut, l'authentification par mot de passe SSH et sudo sans mot de passe sont désactivés sur les instances EC2.)
. Configurez l’installation d’Oracle pour qu’elle corresponde à l’installation Oracle sur site, comme les correctifs du système d’exploitation, les versions et correctifs Oracle, etc.
. Les rôles d'automatisation de base de données NetApp Ansible peuvent être exploités pour configurer des instances EC2 pour les cas d'utilisation de développement/test de base de données et de reprise après sinistre.  Le code d'automatisation peut être téléchargé à partir du site GitHub public de NetApp : https://github.com/NetApp-Automation/na_oracle19c_deploy["Déploiement automatisé d'Oracle 19c"^] .  L’objectif est d’installer et de configurer une pile logicielle de base de données sur une instance EC2 pour correspondre aux configurations de système d’exploitation et de base de données sur site.




==== Configuration de l'instance Windows pour la charge de travail SQL Server

Cette section répertorie les étapes de configuration supplémentaires après le déploiement initial d’une instance Windows EC2.

. Récupérez le mot de passe administrateur Windows pour vous connecter à une instance via RDP.
. Désactivez le pare-feu Windows, joignez l’hôte au domaine Windows SnapCenter et ajoutez l’instance au serveur DNS pour la résolution de noms.
. Provisionnez un volume de journal SnapCenter pour stocker les fichiers journaux SQL Server.
. Configurez iSCSI sur l’hôte Windows pour monter le volume et formater le lecteur de disque.
. Encore une fois, de nombreuses tâches précédentes peuvent être automatisées avec la solution d’automatisation NetApp pour SQL Server.  Consultez le site GitHub public d'automatisation NetApp pour connaître les rôles et solutions récemment publiés : https://github.com/NetApp-Automation["Automatisation NetApp"^] .

